<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Button Example</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="./main.css">
</head>

<body class="bg-slate-500">

    <form class="max-w-md mx-auto" id="formTask">
        <fieldset class="flex flex-wrap">
            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="day-option-1" type="radio" name="days" value="mon"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:focus:bg-blue-600 dark:bg-gray-700 dark:border-gray-600"
                    checked>
                <label for="day-option-1" class="block ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                    Lundi
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="day-option-2" type="radio" name="days" value="tues"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:focus:bg-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="day-option-2" class="block ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                    Mardi
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="day-option-3" type="radio" name="days" value="wed"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="day-option-3" class="block ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                    Mercredi
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="day-option-4" type="radio" name="days" value="thu"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus-ring-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="day-option-4" class="block ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                    Jeudi
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6">
                <input id="day-option-5" type="radio" name="days" value="fri"
                    class="w-4 h-4 border-gray-200 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="day-option-5" class="block ms-2 text-sm font-medium text-gray-300 dark:text-gray-300">
                    Vendredi
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6">
                <input id="day-option-6" type="radio" name="days" value="sat"
                    class="w-4 h-4 border-gray-200 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="day-option-6" class="block ms-2 text-sm font-medium text-gray-300 dark:text-gray-300">
                    Samedi
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6">
                <input id="day-option-7" type="radio" name="days" value="sun"
                    class="w-4 h-4 border-gray-200 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="day-option-7" class="block ms-2 text-sm font-medium text-gray-300 dark:text-gray-300">
                    Dimanche
                </label>
            </div>
        </fieldset>

        <div class="grid md:grid-cols-2 md:gap-6">
            <div class="relative z-0 w-full mb-5 group">
                <input type="text" name="title" id="floating_title"
                    class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer"
                    placeholder=" " required />
                <label for="floating_title"
                    class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6">
                    Titre</label>
            </div>
            <!-- <div class="relative z-0 w-full mb-5 group">
                <input type="text" name="color" id="color"
                    class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer"
                    placeholder=" " required />
                <label for="color"
                    class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6">
                    Couleur</label>
            </div> -->
        </div>
        <fieldset class="flex flex-wrap">
            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="blue" type="radio" name="color" value="blue"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:focus:bg-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="blue" class="block ms-2 text-sm font-medium text-gray-300 dark:text-gray-300">
                    Bleu
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="yellow" type="radio" name="color" value="yellow"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:focus:bg-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="yellow" class="block ms-2 text-sm font-medium text-gray-300 dark:text-gray-300">
                    Jaune
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="red" type="radio" name="color" value="red"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:focus:bg-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="red" class="block ms-2 text-sm font-medium text-gray-300 dark:text-gray-300">
                    Rouge
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="green" type="radio" name="color" value="green"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:focus:bg-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="green" class="block ms-2 text-sm font-medium text-gray-300 dark:text-gray-300">
                    Vert
                </label>
            </div>

            <div class="flex items-center mb-4 mr-6 mt-8">
                <input id="purple" type="radio" name="color" value="purple"
                    class="w-4 h-4 border-gray-300 focus:ring-2 focus:ring-blue-300 dark:focus:ring-blue-600 dark:focus:bg-blue-600 dark:bg-gray-700 dark:border-gray-600">
                <label for="purple" class="block ms-2 text-sm font-medium text-gray-300 dark:text-gray-300">
                    Violet
                </label>
            </div>
        </fieldset>

        <div class="relative z-0 w-full mb-5 group">
            <input type="text" name="description" id="description"
                class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer"
                placeholder=" " required />
            <label for="description"
                class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6">
                Description</label>
        </div>
        <button type="submit" id="createBtn"
            class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Créer</button>
    </form>
    <script>
        const form = document.querySelector('#formTask');
        const createBtn = document.querySelector('#createBtn');

        // Function to change button text and onclick action
        function changeButton() {
            const taskId = localStorage.getItem('taskId');
            if (taskId) {
                createBtn.textContent = "Confirmer la modification";
                createBtn.removeEventListener('click', createOrUpdateTask);
                createBtn.addEventListener('click', modifyTask);
            } else {
                createBtn.textContent = "Confirmer la création";
                createBtn.removeEventListener('click', modifyTask);
                createBtn.addEventListener('click', createOrUpdateTask);
            }
        }

        // Function to clear local storage
        function clearLocalStorage() {
            localStorage.clear();
        }

        // Function to check if localStorage is empty
        function isLocalStorageEmpty() {
            return localStorage.length === 0;
        }

        // Function to handle click event for modification
        function modifyTask(event) {
            event.preventDefault(); // Empêcher la soumission du formulaire
            const taskId = localStorage.getItem('taskId');
            const taskDay = document.querySelector('input[name="days"]:checked').value;
            const taskTitle = document.querySelector('#floating_title').value;
            const taskDescription = document.querySelector('#description').value;
            //comment faire pour précauchée la case de la couleur correspondante ici 
            const taskColor = document.querySelector('input[name="color"]:checked').value;
            console.log("la");
            updateTask(taskId, taskDay, taskTitle, taskColor, taskDescription);
            clearLocalStorage();
        }


        // Function to handle click event for creation or update based on localStorage 
        function createOrUpdateTask(event) {
            event.preventDefault(); // Prevent form submission
            const formData = new FormData(form);
            if (isLocalStorageEmpty()) {
                addTask(formData);
            } else {
                console.log("ici");
                updateTask();
            }
        }

        form.addEventListener('submit', function (event) {
            event.preventDefault();
            const formData = new FormData(form);
            if (isLocalStorageEmpty()) {
                addTask(formData);
            } else {
                
                modifyTask(event);
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            // Récupérer les données depuis le stockage local
            const taskId = localStorage.getItem('taskId');
            const taskTitle = localStorage.getItem('taskTitle');
            const taskDescription = localStorage.getItem('taskDescription');
            const taskColor = localStorage.getItem('taskColor');
            const taskDay = localStorage.getItem('taskDay');

            // Préremplir les champs de saisie avec les données récupérées
            document.querySelector('#floating_title').value = taskTitle;
            document.querySelector("#description").value = taskDescription || "";
            document.querySelector('#color').value = taskColor;

            // Cocher le jour préalablement sélectionné
            document.querySelector(`input[name="days"][value="${taskDay}"]`).checked = true;
            console.log(taskColor);
            document.querySelector(`input[name="color"][value="${taskColor}"]`).checked = true;

            // Changer le bouton si des données existent
            if (taskId) {
                changeButton();
            }
        });
    </script>

</body>


    

<footer class="bg-white rounded-lg shadow m-4 dark:bg-gray-800">
    <div class="w-full mx-auto max-w-screen-xl p-4 md:flex md:items-center md:justify-between">
      <span class="text-sm text-gray-500 sm:text-center dark:text-gray-400">© 2023 <a href="https://flowbite.com/" class="hover:underline">Flowbite™</a>. All Rights Reserved.
    </span>
    <ul class="flex flex-wrap items-center mt-3 text-sm font-medium text-gray-500 dark:text-gray-400 sm:mt-0">
        <li>
            <a href="#" class="hover:underline me-4 md:me-6">About</a>
        </li>
        <li>
            <a href="#" class="hover:underline me-4 md:me-6">Privacy Policy</a>
        </li>
        <li>
            <a href="#" class="hover:underline me-4 md:me-6">Licensing</a>
        </li>
        <li>
            <a href="#" class="hover:underline">Contact</a>
        </li>
    </ul>
    </div>


    <script src="functions.js"></script> <!-- Inclure le fichier functions.js -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
</footer>

</html>